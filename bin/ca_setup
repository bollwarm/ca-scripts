#!/bin/sh

function print_info()
{
	echo
	echo "\033[97m$1\033[39m"
}

print_info "Initialize directory structure"
ca_initialize

print_info "Create Root CA key"
create_root_key

print_info "Create Root certificate"
create_root_certificate

print_info "Do you want to verify he Root certificate? [Y/n] \c"
echo "\033[93m\c"
read ans
if [ -z "$ans" ] || [ $(echo "$ans" | awk '{print toupper($0)}') == "Y" ]
then
	openssl x509 -noout -text -in certs/ca.cert.pem
	echo "\033[97mPress enter to continue.\033[39m\c"
	read
fi

print_info "Create Intermediate CA key"
create_intermediate_key

print_info "Create Intermediate csr"
create_intermediate_csr

print_info "Sign Intermediate certificate"
sign_intermediate_csr

print_info "Create certificate chain."
create_certificate_chain

